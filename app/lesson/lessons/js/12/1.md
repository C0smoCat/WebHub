# Хранение данных

## Куки

Одну из возможностей сохранения данных в javascript представляет использование куки. Для работы с куками в объекте **document** 
предназначено свойство **cookie**.

Для установки куков достаточно свойству `document.cookie` присвоить строку с куками:

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
</head>
<body>

<script>
document.cookie = "login=tom32;";
</script>
</body>
</html>
```

В данном случае устанавливается кука, которая называется "login" и которая имеет значение "tom32". И в большинстве браузеров мы можем посмотреть 
ее, узнать всю информацию о ней и в дальнейшем ее можно использовать в приложении:

![Установка куки в JavaScript](https://metanit.com/web/javascript/pics/cookie.png)

Строка куки принимает до шести различных параметров: имя куки, значение, срок окончания действия (expires), путь (path), домен (domain) и secure. 
Выше использовались только два параметра: имя куки и значение. То есть в случае со строкой "login=tom32;" куки имеет имя login и значение tom32.

Но подобная куки имеет очень ограниченный срок жизни: если явным образом не установить срок действия, то кука будет удалена с закрытием браузера.
Подобная ситуация, возможно, идеальна для тех случаев, когда необходимо удалять всю информацию после завершения работы с веб-приложением и закрытия браузера. 
Однако данное поведение не всегда подходит.

И в этом случае нам надо установить параметр **expires**, то есть срок действия куков:

```js
document.cookie = "login=tom32;expires=Mon, 31 Aug 2015 00:00:00 GMT;";
```

То есть срок действия куки login истекает в понедельник 31 августа 2015 года в 00:00. Формат параметра expires очень важен. Однако его можно сгенерировать программно. 
Для этого мы можем использовать метод **toUTCString()** объекта Date:

```js
var expire = new Date();
expire.setHours(expire.getHours() + 4);
document.cookie = "login=tom32;expires=" + expire.toUTCString() + ";";
```

В данном случае срок действия куки будет составлять 4 часа.

Если в друг нам надо установить куки для какого-то определенного пути на сайте, то мы можем использовать параметр **path**. Например, 
мы хотим установить куки только для пути www.mysite.com/home:

```js
document.cookie = "login=tom32;expires=Mon, 31 Aug 2015 00:00:00 GMT;path=/home;";
```

В этом случае для других путей на сайте, например, www.mysite.com/shop, эти куки будут недоступны.

Если на нашем сайте есть несколько доменов, и мы хотим установить куки непосредственно для определенного домена, тогда можно использовать параметр 
**domain**. Например, у нас на сайте есть поддомен blog.mysite.com:

```js
document.cookie = "login=tom32;expires=Mon, 31 Aug 2015 00:00:00 GMT;path=/;domain=blog.mysite.com;";
```

Параметр `path=/` указывает, что куки будут доступны для всех директорий и путей поддомена blog.mysite.com.

Последний параметр - **secure** задает использование SSL (SecureSockets Layer) и подходит для сайтов, использующих протокол https. 
Если значение этого параметра равно `true`, то куки будут использоваться только при установке защищенного соединения ssl. По умолчанию 
данный параметр равен false.

```js
document.cookie = "login=tom32;expires=Mon, 31 Aug 2015 00:00:00 GMT;path=/;domain=blog.mysite.com;secure=true;";
```

### Получение куки

Для простейшего извлечения куки из браузера достаточно обратиться к свойству **document.cookie**:

```js
var expire = new Date();
expire.setHours(expire.getHours() + 4);

document.cookie = "city=Berlin;expires="+expire.toUTCString()+";";
document.cookie = "country=Germany;expires="+expire.toUTCString()+";";
document.cookie = "login=tom32;";

document.write(document.cookie);
```

Здесь были установлены три куки, и браузер выведет нам все эти куки:

![Получить куки в JavaScript](https://metanit.com/web/javascript/pics/getcookie.png)

Извлеченные куки не включают параметры `expires, path, domain` и `secure`. 
Кроме того, сами куки разделяются точкой с запятой, поэтому нужно еще провести некоторые преобразования, чтобы получить их имя и значение:

```js
var cookies = document.cookie.split(";");
for(var i=0; i<cookies.length; i++){

    var parts = cookies[i].split("="),
        name = parts[0], 
        value = parts[1];
    document.write("Имя куки: " + name + "<br/>");
    document.write("Значение: " + value + "<br/><br/>");
}
```

