## Область видимости переменных

Все переменные в JavaScript имеют определенную область видимости, в пределах которой они могут действовать.

### Глобальные переменные

Все переменные, которые объявлены вне функций, являются глобальными:

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
</head>
<body>
<script>
var x = 5;
let d = 8;
function displaySquare() {

    var z = x * x;
    console.log(z);
}
</script>
</body>
</html>
```

Здесь переменные x и d являются глобальными. Они доступны из любого места программы.

А вот переменная z глобальной не является, так как она определена внутри функции.

### Локальные переменные

Переменная, определенная внутри функции, является локальной:

```js
function displaySquare() {

    var z = 10;
    console.log(z);
    
    let b = 8;
    console.log(b);
}
```

Переменные z и b являются локальными, они существуют только в пределах функции. Вне функции их нельзя использовать:

```js
function displaySquare() {

    var z = 10;
    console.log(z);
}
console.log(z); //ошибка, так как z не определена
```

Когда функция заканчивает свою работу, то все переменные, определенные в функции, уничтожаются.

### Сокрытие переменных

Что если у нас есть две переменных - одна глобальная, а другая локальная, которые имеют одинаковое имя:

```js
var z = 89;
function displaySquare() {

    var z = 10;
    console.log(z); // 10
}
displaySquare(); // 10
```

В этом случае в функции будет использоваться та переменная z, которая определена непосредственно в функции. То есть локальная переменная скроет глобальную.

### var или let

При использовании оператора **let** каждый блок кода определяет новую область видимости, в которой существует переменная. Например, мы можем одновременно определить переменную на уровне блока и на уровне функции:

```js
let z = 10;
function displayZ() {
 
    let z = 20;
    
    {
        let z = 30;
        console.log("Block:", z);
    }
    
    console.log("Function:", z);
}

displayZ();
console.log("Global:", z);
```

Здесь внутри функции displayZ определен блок кода, в котором определена переменная z. Она скрывает глобальную переменную и переменную z, определенную на уровне функции. В реальной программе блок мог быть предеставлять вложенную функцию, блок цикла for или конструкции if. Но в любом случае такой блок определяет новую область видимости, вне которого переменная не существует.

И в данном случае мы получим следующий консольный вывод:

С помощью оператора var мы не можем определить одновременно переменную с одним и тем же именем и в функции, и в блоке кода в этой функции:

```js
function displaySquare() {
 
    var z = 20;
    
    {
        var z = 30;    // Ошибка ! Переменная z уже определена
        console.log("Block:", z);
    }
    console.log("Function:", z);
}
```

То есть с помощью var мы можем определить переменную с одним именем либо на уровне функции, либо на уровне блока кода.

### Константы

Все, что относится к оператору let, относится и к оператору const, который позволяет определить константы. Блоки кода задают область видимости констант, а константы, определенные на вложенных блоках кода, скрывают внешние константы с тем же именем:

```js
const z = 10;
function displayZ() {
 
    const z = 20;
    
    {
        const z = 30;
        console.log("Block:", z);    // 30
    }
    console.log("Function:", z);    // 20
}

displayZ();
console.log("Global:", z);    // 10
```

### Необъявленные переменные

Если мы не используем это ключевое слово при определении переменной в функции, то такая переменная будет глобальной. Например:

```js
function bar() {
    foo = "25";
}
bar();
console.log(foo);    // 25
```

Несмотря на то, что вне функции bar переменная foo нигде не определяется, тем не менее она доступна вне функции во внешнем контексте.

Иначе было бы если бы мы не только присваивали значение переменной, но и определяли бы ее:

```js
function bar() {
    var foo = "25";
}

bar();
console.log(foo);    // ошибка
```

### strict mode

Определение глобальных переменных в функциях может вести к потенциальным ошибкам. Чтобы их избежать используется строгий режим или `strict mode`:

```js
"use strict";
function bar() {
    foo = "25";
}
 
bar();
console.log(foo);
```

В этом случае мы получим ошибку `SyntaxError: Unexpected identifier`, которая говорит о том, что переменная foo не определена.

Установить режим strict mode можно двумя способами:
- добавить выражение "use strict" в начало кода JavaScript, тогда strict mode будет применяться для всего кода
- добавить выражение "use strict" в начало тела функции, тогда strict mode будет применяться только для этой функции


> Материал взят с сайта metanit.com