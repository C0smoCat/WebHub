# Sequelize

Sequelize - это ORM-библиотека для приложений на Node.js, которая осуществляет сопоставление таблиц в бд и отношений между ними с классами. При использовании Sequelize мы можем не писать SQL-запросы, а работать с данными как с обычными объектами. Причем Sequelize может работать с рядом СУБД - MySQL, Postgres, MariaDB, SQLite, MS SQL Server.

Более подробно про работу sequelize можно посмотреть в [официальной документации](http://docs.sequelizejs.com/). А в данном случае мы сосредаточимся на основных моментах работы с данными на примере взаимодействия с БД MySQL.

Вначале установим пакет sequelize.

```

```

## Подключение к базе данных

Для подключения к базе данных прежде всего необходимо создать объект Sequelize:

```js
const Sequelize = require("sequelize");
const sequelize = new Sequelize("usersdb2", "root", "123456", {
  dialect: "mysql",
  host: "localhost"
});
```

Для создания объекта sequelize используется функция **Sequelize**, которая принимает ряд параметров. Первый параметр - имя базы данных. Второй параметр - логин к бд, третий параметр - пароль. Это обязательные параметры.

Кроме того, с помощью четвертого параметра мы можем задать ряд дополнительных опций конфигурации. Четвертый параметр представляет объект, который имеет множество свойств. В данном случае используются только два. Первое свойство - `dialect` указывает на диалект языка SQL, который используется в запросах - в данном случае "mysql". Второе свойство `host` представляет адрес, по которому запущен сервер. По умолчанию `host` имеет значение "localhost", поэтому для подключения к локальной базе данных это свойство в принципе можно не указывать.

Для свойства **dialect** в зависимости от того, с какой СУБД предстоит работать, могут использоваться следующие значения:
- `mysql`
- `mariadb`
- `sqlite`
- `postgres`
- `mssql`

### Подключение к mysql

Для работы с MySQL также должен быть установлен пакет **mysql2**, работа с котором разбиралась в прошлой главе:



```

```

И при создании объекта Sequelize в параметрах указывается `dialect: "mysql"`:

```js
const Sequelize = require("sequelize");
const sequelize = new Sequelize("usersdb2", "root", "123456", {
  dialect: "mysql",
  host: "localhost"
});
```

### Подключение к mssql

Для работы с MS SQL Server в проекте должен быть установлен пакет **tedious**:



```

```

И при создании объекта Sequelize в параметрах указывается `dialect: "mssql"`:

```js
const Sequelize = require("sequelize");
const sequelize = new Sequelize("usersdb2", "sa", "123456", {
  dialect: "mssql",
  host: "localhost",
  port: "1433"
});
```

Кроме диалекта в настройках конфигурации также указывается параметр **host** - адрес сервера и **port**. Если сервер запущен на порту 1433, то в принципе его необязательно указывать, так как этот порт Sequelize использует по умолчанию. Любой другой порт необходимо указывать.

При создании подключения к MSSQL Server мы можем столкнуться с рядом сложностей, которые вытекают в основном из конфигурации самого сервера. Прежде всего, нам надо убедиться, что запущенный экземпляр сервера принимает запросы по TCP. Для этого перейдем в панели управления к пункту **Администрирование** и затем выберем пункт **Управление компьютером**

![Настройка MS SQL Server для Sequelize](https://metanit.com/web/nodejs/pics/10.5.png)

В открывшейся вкладке перейдем к пункту **Службы и приложения -> SQL Server Configuration Manager -> SQL Server Network Configuration** и найдем нужный нам экземпляр сервера. Убедимся, что для включен параметр **TCP/IP** (то есть имеет значение "Enabled").

![Настройка порта MS SQL Server для Sequelize](https://metanit.com/web/nodejs/pics/10.6.png)

Для использования логина и пароля в MS SQL Server убедимся, что он настроен на смешанную аутентификацию. Для этого подключимся к серверу через SQL Server Managemen Studio и перейдем к свойствам сервера:

![Настройка логина и пароля MS SQL Server для Sequelize](https://metanit.com/web/nodejs/pics/10.7.png)

Затем в открывшемся окне на вкладке **Security** выбрем режим **SQL Server and Windows Authentication mode**.

![Windows Authentication for MS SQL Server in Sequelize](https://metanit.com/web/nodejs/pics/10.8.png)

После применения всех настроек перезапустим сервер.

И естественно перед подключением необходимо создать базу данных, с которой будет идти взаимодействие.

### Подключение к postgres

Для работы с СУБД Postgres также необходимо установить пакет **pg**:



```

```

И при создании объекта Sequelize в параметрах указывается `dialect: "postgres"`:

```js
const Sequelize = require("sequelize");
const sequelize = new Sequelize("usersdb2", "root", "123456", {
  dialect: "postgres"
});
```

Все остальное взаимодействие с базой данных в большинстве случаев за некоторыми исключениями практически не зависит от конкретной СУБД. А это значит, что большую часть кода (если не весь код) мы можем использовать для подключения к разным СУБД.


> Материал взят с сайта metanit.com