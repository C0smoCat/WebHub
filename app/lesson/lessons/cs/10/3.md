## Форматирование и интерполяция строк

### Форматирование строк

При выводе строк в консоли с помощью метода Console.WriteLine мы можем применять форматирование вместо конкатенации:

```cs
class Program
{
    static void Main(string[] args)
    {
        Person person = new Person { Name = "Tom", Age = 23 };

        Console.WriteLine("Имя: {0}  Возраст: {1}", person.Name, person.Age);
        Console.Read();
    }
}

class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
}
```

В строке "Имя: {0}  Возраст: {1}" на место `{0}` и `{1}` затем будут вставляться в порядке следования `person.Name` и `person.Age`

То же самое мы можем сделать с помощью метода **String.Format**:

```cs
string output = String.Format("Имя: {0}  Возраст: {1}", person.Name, person.Age);
Console.WriteLine(output);
```

Метод `Format` принимает строку с плейсхолдерами типа {0}, {1} и т.д., а также набор аргументов, которые вставляются на место данных плейсхолдеров. В итоге генерируется новая строка.

В методе Format могут использоваться различные спецификаторы и описатели, которые позволяют настроить вывод данных. Рассмотрим основные описатели.

| C / c | Задает формат денежной единицы, указывает количество десятичных разрядов после запятой                   |
|-------|----------------------------------------------------------------------------------------------------------|
| D / d | Целочисленный формат, указывает минимальное количество цифр                                              |
| E / e | Экспоненциальное представление числа, указывает количество десятичных разрядов после запятой             |
| F / f | Формат дробных чисел с фиксированной точкой, указывает количество десятичных разрядов после запятой      |
| G / g | Задает более короткий из двух форматов: F или E                                                          |
| N / n | Также задает формат дробных чисел с фиксированной точкой, определяет количество разрядов после запятой   |
| P / p | Задает отображения знака процентов рядом с число, указывает количество десятичных разрядов после запятой |
| X / x | Шестнадцатеричный формат числа                                                                           |
Для форматирования валюты используется описатель "C":

```cs
double number = 23.7;
string result = String.Format("{0:C}", number);
Console.WriteLine(result); // $ 23.7
string result2 = String.Format("{0:C2}", number);
Console.WriteLine(result2); // $ 23.70
```

Число после описателя указывает, сколько чисел будет использоваться после разделителя между целой и дробной частью. При выводе также добавляется обозначение денежного знака для текущей культуры компьютера.

Для форматирования целочисленных значение применяется описатель "d":

```cs
int number = 23;
string result = String.Format("{0:d}", number);
Console.WriteLine(result); // 23
string result2 = String.Format("{0:d4}", number);
Console.WriteLine(result2); // 0023
```

Число после описателя указывает, сколько цифр будет в числовом значении. Если в исходном числе цифр меньше, то к нему добавляются нули.

Для форматирования дробны чисел используется описатель F, число после которого указывает, сколько знаков будет использоваться после разделителя между целой и дробной частью. Если исходное число - целое, то к нему добавляются разделитель и нули.

```cs
int number = 23;
string result = String.Format("{0:f}", number);
Console.WriteLine(result); // 23,00

double number2 = 45.08;
string result2 = String.Format("{0:f4}", number2);
Console.WriteLine(result2); // 45,0800

double number3 = 25.07;
string result3 = String.Format("{0:f1}", number3);
Console.WriteLine(result2); // 25,1
```

Описатель "P" задает отображение процентов. Используемый с ним числовой спецификатор указывает, сколько знаков будет после запятой:

```cs
decimal number = 0.15345m;
Console.WriteLine("{0:P1}", number);// 15.3%
```

Используя знак #, можно настроить формат вывода. Например, нам надо вывести некоторое число в формате телефона +х (ххх)ххх-хх-хх:

```cs
long number = 19876543210;
string result = String.Format("{0:+# (###) ###-##-##}", number);
Console.WriteLine(result); // +1 (987) 654-32-10
```

### Метод ToString

Метод `ToString()` не только получает строковое описание объекта, но и может осуществлять форматирование. Он поддерживает те же описатели, что используются в методе Format:

```cs
long number = 19876543210;
Console.WriteLine(number.ToString("+# (###) ###-##-##"));// +1 (987) 654-32-10

double money = 24.8;
Console.WriteLine(money.ToString("C2")); // $ 24,80
```

### Интерполяция строк

Начиная с версии языка C# 6.0 была добавлена такая функциональность, как интерполяция строк. Эта функциональность призвана заменить форматирование строк. Так, перепишем пример с выводом значений свойств объекта Person:

```cs
Person person = new Person { Name = "Tom", Age = 23 };

Console.WriteLine($"Имя: {person.Name}  Возраст: {person.Age}");
```

Знак доллара перед строкой указывает, что будет осуществляться интерполяция строк. Внутри строки опять же используются плейсхолдеры `{...}`, только внутри фигурных скобок уже можно напрямую писать те выражения, которые мы хотим вывести.

Интерполяция по сути представляет более лаконичное форматирование. При этом внутри фигурных скобок мы можем указывать не только свойства, но и различные выражения языка C#:

```cs
int x = 8;
int y = 7;
string result = $"{x} + {y} = {x + y}";
Console.WriteLine(result); // 8 + 7 = 15
```

В следующем примере проверяем, не равен ли person значению null. Если не равен, то выводим его имя, иначе выводим какое-нибудь имя по умолчанию:

```cs
person = null;
string output = $"{person?.Name??"Имя по умолчанию"}";
Console.WriteLine(output);
```

Уже внутри строки можно применять форматирование. В этом случае мы можем применять все те же описатели, что и в методе `Format`. Например, выведем номер телефона в формате +x xxx-xxx-xx-xx:

```cs
long number = 19876543210;
Console.WriteLine($"{number:+# ### ### ## ##}"); // +1 987 654 32 10
```

Добавляем пространство до и после форматируемого вывода:

```cs
Console.WriteLine($"Имя: {person.Name, -5} Возраст: {person.Age}"); // пробелы после
Console.WriteLine($"Имя: {person.Name, 5} Возраст: {person.Age}"); // пробелы до
```

Вывод:

```

```


> Материал взят с сайта metanit.com